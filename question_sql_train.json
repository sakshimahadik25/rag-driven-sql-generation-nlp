[
    {
        "question": "What is the average unit price of products sold by each branch?",
        "sql": "SELECT Branch, AVG(Unit_price) AS avg_unit_price FROM sales GROUP BY Branch ORDER BY avg_unit_price DESC;"
    },
    {
        "question": "What is the total quantity of each product line sold by each gender?",
        "sql": "SELECT Product_line, Gender, SUM(Quantity) AS total_quantity FROM sales GROUP BY Product_line, Gender ORDER BY total_quantity DESC;"
    },
    {
        "question": "Which branch has the lowest gross income per sale?",
        "sql": "SELECT Branch, AVG(gross_income) AS avg_gross_income FROM sales GROUP BY Branch ORDER BY avg_gross_income ASC LIMIT 1;"
    },
    {
        "question": "What is the total VAT collected by each branch?",
        "sql": "SELECT Branch, SUM(`Tax 5%`) AS total_vat FROM sales GROUP BY Branch ORDER BY total_vat DESC;"
    },
    {
        "question": "Identify the month with the highest gross income for each city.",
        "sql": "SELECT City, MONTH(Date) AS month, SUM(gross_income) AS total_income FROM sales GROUP BY City, month ORDER BY total_income DESC;"
    },
    {
        "question": "What is the most common rating given by customers by gender?",
        "sql": "SELECT Gender, Rating, COUNT(Rating) AS rating_count FROM sales GROUP BY Gender, Rating ORDER BY rating_count DESC;"
    },
    {
        "question": "What is the total revenue for each product line by branch?",
        "sql": "SELECT Branch, Product_line, SUM(Total) AS total_revenue FROM sales GROUP BY Branch, Product_line ORDER BY total_revenue DESC;"
    },
    {
        "question": "What is the highest rating given to each product line?",
        "sql": "SELECT Product_line, MAX(Rating) AS highest_rating FROM sales GROUP BY Product_line ORDER BY highest_rating DESC;"
    },
    {
        "question": "How many transactions were made with each payment method for each customer type?",
        "sql": "SELECT Payment, Customer_type, COUNT(Invoice_ID) AS transaction_count FROM sales GROUP BY Payment, Customer_type ORDER BY transaction_count DESC;"
    },
    {
        "question": "Which customer type contributed the most to gross income in each city?",
        "sql": "SELECT City, Customer_type, SUM(gross_income) AS total_gross_income FROM sales GROUP BY City, Customer_type ORDER BY total_gross_income DESC;"
    },
    {
        "question": "What is the total quantity of products sold during the weekend?",
        "sql": "SELECT SUM(Quantity) AS weekend_quantity FROM sales WHERE DAYNAME(Date) IN ('Saturday', 'Sunday');"
    },
    {
        "question": "Calculate the average revenue per transaction for each city.",
        "sql": "SELECT City, AVG(Total) AS avg_revenue FROM sales GROUP BY City ORDER BY avg_revenue DESC;"
    },
    {
        "question": "Which day of the week had the highest total revenue for each branch?",
        "sql": "SELECT Branch, DAYNAME(Date) AS day, SUM(Total) AS total_revenue FROM sales GROUP BY Branch, day ORDER BY total_revenue DESC;"
    },
    {
        "question": "Identify the time of day with the highest quantity of products sold for each branch.",
        "sql": "SELECT Branch, HOUR(Time) AS hour, SUM(Quantity) AS total_quantity FROM sales GROUP BY Branch, hour ORDER BY total_quantity DESC;"
    },
    {
        "question": "What is the average gross margin percentage by product line?",
        "sql": "SELECT Product_line, AVG(`gross margin percentage`) AS avg_margin_pct FROM sales GROUP BY Product_line ORDER BY avg_margin_pct DESC;"
    },
    {
        "question": "What is the distribution of total revenue by customer type for each city?",
        "sql": "SELECT City, Customer_type, SUM(Total) AS total_revenue FROM sales GROUP BY City, Customer_type ORDER BY total_revenue DESC;"
    },
    {
        "question": "What is the average total revenue generated by each payment method?",
        "sql": "SELECT Payment, AVG(Total) AS avg_revenue FROM sales GROUP BY Payment ORDER BY avg_revenue DESC;"
    },
    {
        "question": "Which gender generated the most gross income on average in each branch?",
        "sql": "SELECT Branch, Gender, AVG(gross_income) AS avg_gross_income FROM sales GROUP BY Branch, Gender ORDER BY avg_gross_income DESC;"
    },
    {
        "question": "Identify the time slot (hour) with the highest total revenue by city.",
        "sql": "SELECT City, HOUR(Time) AS hour, SUM(Total) AS total_revenue FROM sales GROUP BY City, hour ORDER BY total_revenue DESC;"
    },
    {
        "question": "What is the highest quantity of products sold in a single transaction by each branch?",
        "sql": "SELECT Branch, MAX(Quantity) AS max_quantity FROM sales GROUP BY Branch ORDER BY max_quantity DESC;"
    },
    {
        "question": "What is the lowest rating received for each product line?",
        "sql": "SELECT Product_line, MIN(Rating) AS lowest_rating FROM sales GROUP BY Product_line ORDER BY lowest_rating ASC;"
    },
    {
        "question": "Which branch has the highest gross margin percentage on average?",
        "sql": "SELECT Branch, AVG(`gross margin percentage`) AS avg_margin FROM sales GROUP BY Branch ORDER BY avg_margin DESC LIMIT 1;"
    },
    {
        "question": "How many transactions were made for each product line in each city?",
        "sql": "SELECT City, Product_line, COUNT(Invoice_ID) AS transaction_count FROM sales GROUP BY City, Product_line ORDER BY transaction_count DESC;"
    },
    {
        "question": "What is the sum of VAT collected by each payment method?",
        "sql": "SELECT Payment, SUM(`Tax 5%`) AS total_vat FROM sales GROUP BY Payment ORDER BY total_vat DESC;"
    },
    {
        "question": "Identify the hour with the highest gross income by gender.",
        "sql": "SELECT Gender, HOUR(Time) AS hour, SUM(gross_income) AS total_income FROM sales GROUP BY Gender, hour ORDER BY total_income DESC;"
    },
    {
        "question": "What is the highest quantity sold in a transaction for each customer type?",
        "sql": "SELECT Customer_type, MAX(Quantity) AS max_quantity FROM sales GROUP BY Customer_type ORDER BY max_quantity DESC;"
    },
    {
        "question": "What is the total VAT collected on products sold by male customers?",
        "sql": "SELECT Gender, SUM(`Tax 5%`) AS total_vat FROM sales WHERE Gender = 'Male' GROUP BY Gender;"
    },
    {
        "question": "What is the average gross income per transaction for female customers?",
        "sql": "SELECT AVG(gross_income) AS avg_gross_income FROM sales WHERE Gender = 'Female';"
    },
    {
        "question": "Which city has the highest average total per transaction?",
        "sql": "SELECT City, AVG(Total) AS avg_total FROM sales GROUP BY City ORDER BY avg_total DESC LIMIT 1;"
    },
    {
        "question": "What is the most common product line purchased by female customers in each branch?",
        "sql": "SELECT Branch, Product_line, COUNT(*) AS purchase_count FROM sales WHERE Gender = 'Female' GROUP BY Branch, Product_line ORDER BY purchase_count DESC;"
    },
    {
        "question": "Which day of the month generates the highest revenue on average?",
        "sql": "SELECT DAY(Date) AS day_of_month, AVG(Total) AS avg_revenue FROM sales GROUP BY day_of_month ORDER BY avg_revenue DESC LIMIT 1;"
    },
    {
        "question": "What is the average rating by city for male customers?",
        "sql": "SELECT City, AVG(Rating) AS avg_rating FROM sales WHERE Gender = 'Male' GROUP BY City ORDER BY avg_rating DESC;"
    },
    {
        "question": "What is the highest VAT collected on a single transaction?",
        "sql": "SELECT MAX(`Tax 5%`) AS max_vat FROM sales;"
    },
    {
        "question": "Which city has the lowest total revenue collected from female customers?",
        "sql": "SELECT City, SUM(Total) AS total_revenue FROM sales WHERE Gender = 'Female' GROUP BY City ORDER BY total_revenue ASC LIMIT 1;"
    },
    {
        "question": "What is the average quantity of each product line purchased by male customers?",
        "sql": "SELECT Product_line, AVG(Quantity) AS avg_quantity FROM sales WHERE Gender = 'Male' GROUP BY Product_line ORDER BY avg_quantity DESC;"
    },
    {
        "question": "Which time of day (morning, afternoon, evening) has the highest revenue for each city?",
        "sql": "SELECT City, CASE WHEN HOUR(Time) < 12 THEN 'Morning' WHEN HOUR(Time) < 18 THEN 'Afternoon' ELSE 'Evening' END AS time_of_day, SUM(Total) AS total_revenue FROM sales GROUP BY City, time_of_day ORDER BY total_revenue DESC;"
    },
    {
        "question": "What is the average rating given by customer type during weekends?",
        "sql": "SELECT Customer_type, AVG(Rating) AS avg_rating FROM sales WHERE DAYNAME(Date) IN ('Saturday', 'Sunday') GROUP BY Customer;"
    }
]
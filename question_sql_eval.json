{
    "Generic Questions": [
        { "question": "How many transactions were made by each customer type?", "sql": "SELECT Customer_type, COUNT(Invoice_ID) FROM sales GROUP BY Customer_type;" },
        { "question": "Which branch made the highest number of sales?", "sql": "SELECT Branch, SUM(quantity) AS sales_count FROM sales GROUP BY Branch ORDER BY sales_count DESC LIMIT 1;" },
        { "question": "What is the earliest sale date recorded?", "sql": "SELECT MIN(Date) AS earliest_date FROM sales;" },
        { "question": "What is the most recent sale date recorded?", "sql": "SELECT MAX(Date) AS latest_date FROM sales;" }
    ],
    "Product Analysis": [
        { "question": "Which gender purchases the most products?", "sql": "SELECT Gender, SUM(Quantity) AS total_quantity FROM sales GROUP BY Gender ORDER BY total_quantity DESC LIMIT 1;" },
        { "question": "What is the total revenue generated by each product line?", "sql": "SELECT Product_line, SUM(Total) AS revenue FROM sales GROUP BY Product_line ORDER BY revenue DESC;" },
        { "question": "What is the most commonly purchased product line for each city?", "sql": "WITH ranked_sales AS ( SELECT city, product_line,COUNT(*) AS purchase_count, RANK() OVER (PARTITION BY city ORDER BY COUNT(*) DESC) AS rank1 FROM sales GROUP BY city, product_line) SELECT city, product_line, purchase_count FROM ranked_sales WHERE rank1 = 1;" },
        { "question": "Which product line has the highest average rating?", "sql": "SELECT Product_line, AVG(Rating) AS avg_rating FROM sales GROUP BY Product_line ORDER BY avg_rating DESC LIMIT 1;" },
        { "question": "Calculate the revenue per unit for each product line.", "sql": "SELECT Product_line, SUM(Total)/SUM(Quantity) AS revenue_per_unit FROM sales GROUP BY Product_line;" }
    ],
    "Sales Analysis": [
        { "question": "How does the quantity sold vary across different times of the day?", "sql": "SELECT HOUR(Time) AS hour, SUM(Quantity) AS total_quantity FROM sales GROUP BY hour ORDER BY total_quantity DESC;" },
        { "question": "What is the average total revenue per transaction?", "sql": "SELECT AVG(Total) AS average_revenue FROM sales;" },
        { "question": "What is the total VAT collected each month?", "sql": "SELECT MONTH(Date) AS month, SUM(vat) AS total_vat FROM sales GROUP BY month;" },
        { "question": "Which time of day records the highest average rating?", "sql": "SELECT TIME_FORMAT(Time, '%H:00') AS hour, AVG(Rating) AS avg_rating FROM sales GROUP BY hour ORDER BY avg_rating DESC LIMIT 1;" }
    ],
    "Revenue Analysis": [
        { "question": "What is the average revenue generated per branch?", "sql": "SELECT Branch, AVG(Total) AS avg_revenue FROM sales GROUP BY Branch ORDER BY avg_revenue DESC;" },
        { "question": "What is the total revenue for each city?", "sql": "SELECT City, SUM(Total) AS city_revenue FROM sales GROUP BY City ORDER BY city_revenue DESC;" },
        { "question": "What is the average revenue per customer type?", "sql": "SELECT Customer_type, AVG(Total) AS avg_revenue FROM sales GROUP BY Customer_type;" },
        { "question": "How much revenue did each payment method generate?", "sql": "SELECT Payment, SUM(Total) AS payment_revenue FROM sales GROUP BY Payment ORDER BY payment_revenue DESC;" }
    ],
    "Customer Analysis": [
        { "question": "What is the most preferred payment method by gender?", "sql": "WITH ranked_payments AS ( SELECT Gender,Payment, COUNT(*) AS payment_count, RANK() OVER (PARTITION BY Gender ORDER BY COUNT(*) DESC) AS rank1 FROM sales GROUP BY Gender, Payment) SELECT Gender, Payment, payment_count FROM ranked_payments WHERE rank1 = 1;" },
        { "question": "What is the total revenue generated by each gender?", "sql": "SELECT Gender, SUM(Total) AS revenue FROM sales GROUP BY Gender ORDER BY revenue DESC;" },
        { "question": "What is the average quantity of items purchased by each customer type?", "sql": "SELECT Customer_type, AVG(Quantity) AS avg_quantity FROM sales GROUP BY Customer_type;" },
        { "question": "What is the most common payment method used by each gender?", "sql": "WITH ranked_payments AS ( SELECT Gender,Payment, COUNT(*) AS payment_count, RANK() OVER (PARTITION BY Gender ORDER BY COUNT(*) DESC) AS rank1 FROM sales GROUP BY Gender, Payment) SELECT Gender, Payment, payment_count FROM ranked_payments WHERE rank1 = 1;" }
    ],
    "Time Analysis": [
        { "question": "Which month has the highest average rating?", "sql": "SELECT MONTH(Date) AS month, AVG(Rating) AS avg_rating FROM sales GROUP BY month ORDER BY avg_rating DESC LIMIT 1;" },
        { "question": "What is the total VAT collected in each quarter?", "sql": "SELECT QUARTER(Date) AS quarter, SUM(vat) AS total_vat FROM sales GROUP BY quarter ORDER BY total_vat DESC;" }
    ],
    "Performance Analysis": [
        { "question": "Which branch has the highest gross income?", "sql": "SELECT Branch, SUM(gross_income) AS total_gross_income FROM sales GROUP BY Branch ORDER BY total_gross_income DESC LIMIT 1;" },
        { "question": "How does the quantity sold vary with each payment method?", "sql": "SELECT Payment, AVG(Quantity) AS avg_quantity FROM sales GROUP BY Payment ORDER BY avg_quantity DESC;" },
        { "question": "What is the most common product line for transactions above 500?", "sql": "SELECT Product_line, COUNT(*) AS product_count FROM sales WHERE Total > 500 GROUP BY Product_line ORDER BY product_count DESC;" }
    ],
    "Customer Trends": [
        { "question": "How many transactions did each gender make during time 18 and 21?", "sql": "SELECT Gender, COUNT(Invoice_ID) AS transaction_count FROM sales WHERE HOUR(Time) BETWEEN 18 AND 21 GROUP BY Gender ORDER BY transaction_count DESC;" }
    ]
}
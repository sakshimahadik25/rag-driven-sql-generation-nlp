Question,Generated SQL,Ground Truth SQL,Generated SQL Output,Error Classification,Similarity Analysis
How many transactions were made by each customer type?,"SELECT Customer_type, COUNT(Invoice_ID) AS transaction_count FROM sales GROUP BY Customer_type ORDER BY transaction_count;","SELECT Customer_type, COUNT(Invoice_ID) FROM sales GROUP BY Customer_type;","  Customer_type  transaction_count
0        Normal                499
1        Member                501",Correct,Wrong Answer
Which branch made the highest number of sales?,"SELECT Branch, COUNT(Invoice_ID) AS sales_count FROM sales GROUP BY Branch ORDER BY sales_count DESC LIMIT 1;","SELECT Branch, SUM(quantity) AS sales_count FROM sales GROUP BY Branch ORDER BY sales_count DESC LIMIT 1;","  Branch  sales_count
0      A          340",Wrong Answer,Almost Correct
What is the earliest sale date recorded?,SELECT MIN(Date) AS earliest_sale_date FROM sales;,SELECT MIN(Date) AS earliest_date FROM sales;,"  earliest_sale_date
0         2019-01-01",Correct,Almost Correct
What is the most recent sale date recorded?,SELECT MAX(Date) AS most_recent_sale_date FROM sales;,SELECT MAX(Date) AS latest_date FROM sales;,"  most_recent_sale_date
0            2019-03-30",Correct,Almost Correct
Which gender purchases the most products?,"SELECT Gender, COUNT(Product_line) AS product_count FROM sales GROUP BY Gender ORDER BY product_count DESC;","SELECT Gender, SUM(Quantity) AS total_quantity FROM sales GROUP BY Gender ORDER BY total_quantity DESC LIMIT 1;","   Gender  product_count
0  Female            501
1    Male            499",Wrong Answer,Wrong Answer
What is the total revenue generated by each product line?,"SELECT Product_line, SUM(Total) AS total_revenue FROM sales GROUP BY Product_line ORDER BY total_revenue DESC;","SELECT Product_line, SUM(Total) AS revenue FROM sales GROUP BY Product_line ORDER BY revenue DESC;","             Product_line total_revenue
0      Food and beverages    56144.8440
1       Sports and travel    55122.8265
2  Electronic accessories    54337.5315
3     Fashion accessories    54305.8950
4      Home and lifestyle    53861.9130
5       Health and beauty    49193.7390",Correct,Almost Correct
What is the most commonly purchased product line for each city?,"SELECT City, Product_line, COUNT(*) AS purchase_count FROM sales GROUP BY City, Product_line ORDER BY purchase_count DESC;","WITH ranked_sales AS ( SELECT city, product_line,COUNT(*) AS purchase_count, RANK() OVER (PARTITION BY city ORDER BY COUNT(*) DESC) AS rank1 FROM sales GROUP BY city, product_line) SELECT city, product_line, purchase_count FROM ranked_sales WHERE rank1 = 1;","         City            Product_line  purchase_count
0   Naypyitaw      Food and beverages              66
1      Yangon      Home and lifestyle              65
2   Naypyitaw     Fashion accessories              65
3    Mandalay     Fashion accessories              62
4    Mandalay       Sports and travel              62
5      Yangon  Electronic accessories              60
6      Yangon       Sports and travel              59
7      Yangon      Food and beverages              58
8   Naypyitaw  Electronic accessories              55
9    Mandalay  Electronic accessories              55
10   Mandalay       Health and beauty              53
11  Naypyitaw       Health and beauty              52
12     Yangon     Fashion accessories              51
13   Mandalay      Food and beverages              50
14   Mandalay      Home and lifestyle              50
15     Yangon       Health and beauty              47
16  Naypyitaw      Home and lifestyle              45
17  Naypyitaw       Sports and travel              45",Wrong Answer,Wrong Answer
Which product line has the highest average rating?,"SELECT Product_line, AVG(Rating) AS avg_rating FROM sales GROUP BY Product_line ORDER BY avg_rating DESC LIMIT 1;","SELECT Product_line, AVG(Rating) AS avg_rating FROM sales GROUP BY Product_line ORDER BY avg_rating DESC LIMIT 1;","         Product_line  avg_rating
0  Food and beverages     7.11322",Correct,Almost Correct
Calculate the revenue per unit for each product line.,"SELECT Product_line, AVG(Total) AS revenue_per_unit FROM sales GROUP BY Product_line;","SELECT Product_line, SUM(Total)/SUM(Quantity) AS revenue_per_unit FROM sales GROUP BY Product_line;","             Product_line revenue_per_unit
0      Food and beverages     322.67151724
1       Health and beauty     323.64301974
2       Sports and travel     332.06521988
3     Fashion accessories     305.08929775
4      Home and lifestyle     336.63695625
5  Electronic accessories     319.63253824",Wrong Answer,Almost Correct
How does the quantity sold vary across different times of the day?,"SELECT HOUR(Time) AS hour, AVG(Quantity) AS avg_quantity FROM sales GROUP BY hour ORDER BY avg_quantity DESC;","SELECT HOUR(Time) AS hour, SUM(Quantity) AS total_quantity FROM sales GROUP BY hour ORDER BY total_quantity DESC;","    hour avg_quantity
0     14       5.9639
1     19       5.7434
2     11       5.7000
3     13       5.6796
4     12       5.6292
5     17       5.6081
6     16       5.4545
7     20       5.3600
8     10       5.1980
9     15       5.1961
10    18       5.1075",Wrong Answer,Almost Correct
What is the average total revenue per transaction?,SELECT AVG(Total) AS avg_revenue FROM sales;,SELECT AVG(Total) AS average_revenue FROM sales;,"    avg_revenue
0  322.96674900",Correct,Almost Correct
What is the total VAT collected each month?,"SELECT MONTH(Date) AS month, SUM(vat) AS total_vat FROM sales GROUP BY month ORDER BY total_vat DESC;","SELECT MONTH(Date) AS month, SUM(vat) AS total_vat FROM sales GROUP BY month;","   month  total_vat
0      1   5537.708
1      3   5212.167
2      2   4629.494",Correct,Almost Correct
Which time of day records the highest average rating?,"SELECT HOUR(Time) AS hour, AVG(Rating) AS avg_rating FROM sales GROUP BY hour ORDER BY avg_rating DESC LIMIT 1;","SELECT TIME_FORMAT(Time, '%H:00') AS hour, AVG(Rating) AS avg_rating FROM sales GROUP BY hour ORDER BY avg_rating DESC LIMIT 1;","   hour  avg_rating
0    12         7.3",Wrong Answer,Almost Correct
What is the average revenue generated per branch?,"SELECT Branch, AVG(Total) AS avg_revenue FROM sales GROUP BY Branch;","SELECT Branch, AVG(Total) AS avg_revenue FROM sales GROUP BY Branch ORDER BY avg_revenue DESC;","  Branch   avg_revenue
0      A  312.35403088
1      C  337.09971494
2      B  319.87250602",Correct,Almost Correct
What is the total revenue for each city?,"SELECT City, SUM(Total) AS total_revenue FROM sales GROUP BY City ORDER BY total_revenue DESC;","SELECT City, SUM(Total) AS city_revenue FROM sales GROUP BY City ORDER BY city_revenue DESC;","        City total_revenue
0  Naypyitaw   110568.7065
1     Yangon   106200.3705
2   Mandalay   106197.6720",Correct,Almost Correct
What is the average revenue per customer type?,"SELECT Customer_type, AVG(Total) AS avg_revenue FROM sales GROUP BY Customer_type;","SELECT Customer_type, AVG(Total) AS avg_revenue FROM sales GROUP BY Customer_type;","  Customer_type   avg_revenue
0        Normal  318.12285571
1        Member  327.79130539",Correct,Almost Correct
How much revenue did each payment method generate?,"SELECT Payment, SUM(Total) AS revenue FROM sales GROUP BY Payment ORDER BY revenue DESC;","SELECT Payment, SUM(Total) AS payment_revenue FROM sales GROUP BY Payment ORDER BY payment_revenue DESC;","       Payment      revenue
0         Cash  112206.5700
1      Ewallet  109993.1070
2  Credit card  100767.0720",Correct,Almost Correct
What is the most preferred payment method by gender?,"SELECT Gender, Payment, COUNT(*) AS payment_count FROM sales GROUP BY Gender, Payment ORDER BY payment_count DESC;","WITH ranked_payments AS ( SELECT Gender,Payment, COUNT(*) AS payment_count, RANK() OVER (PARTITION BY Gender ORDER BY COUNT(*) DESC) AS rank1 FROM sales GROUP BY Gender, Payment) SELECT Gender, Payment, payment_count FROM ranked_payments WHERE rank1 = 1;","   Gender      Payment  payment_count
0    Male      Ewallet            185
1  Female         Cash            178
2    Male         Cash            166
3  Female  Credit card            163
4  Female      Ewallet            160
5    Male  Credit card            148",Wrong Answer,Wrong Answer
What is the total revenue generated by each gender?,"SELECT Gender, SUM(Total) AS total_revenue FROM sales GROUP BY Gender ORDER BY total_revenue DESC;","SELECT Gender, SUM(Total) AS revenue FROM sales GROUP BY Gender ORDER BY revenue DESC;","   Gender total_revenue
0  Female   167882.9250
1    Male   155083.8240",Correct,Almost Correct
What is the average quantity of items purchased by each customer type?,"SELECT Customer_type, AVG(Quantity) AS avg_quantity FROM sales GROUP BY Customer_type;","SELECT Customer_type, AVG(Quantity) AS avg_quantity FROM sales GROUP BY Customer_type;","  Customer_type avg_quantity
0        Normal       5.4609
1        Member       5.5589",Correct,Almost Correct
What is the most common payment method used by each gender?,"SELECT Gender, Payment, COUNT(*) AS payment_count FROM sales GROUP BY Gender, Payment ORDER BY payment_count DESC;","WITH ranked_payments AS ( SELECT Gender,Payment, COUNT(*) AS payment_count, RANK() OVER (PARTITION BY Gender ORDER BY COUNT(*) DESC) AS rank1 FROM sales GROUP BY Gender, Payment) SELECT Gender, Payment, payment_count FROM ranked_payments WHERE rank1 = 1;","   Gender      Payment  payment_count
0    Male      Ewallet            185
1  Female         Cash            178
2    Male         Cash            166
3  Female  Credit card            163
4  Female      Ewallet            160
5    Male  Credit card            148",Wrong Answer,Wrong Answer
Which month has the highest average rating?,"SELECT MONTH(Date) AS month, AVG(Rating) AS avg_rating FROM sales GROUP BY month ORDER BY avg_rating DESC LIMIT 1;","SELECT MONTH(Date) AS month, AVG(Rating) AS avg_rating FROM sales GROUP BY month ORDER BY avg_rating DESC LIMIT 1;","   month  avg_rating
0      2     7.06997",Correct,Almost Correct
What is the total VAT collected in each quarter?,"SELECT Quarter(Date) AS quarter, SUM(VAT) AS total_vat FROM sales GROUP BY quarter ORDER BY total_vat DESC;","SELECT QUARTER(Date) AS quarter, SUM(vat) AS total_vat FROM sales GROUP BY quarter ORDER BY total_vat DESC;","   quarter  total_vat
0        1  15379.369",Correct,Almost Correct
Which branch has the highest gross income?,"SELECT Branch AS branch, SUM(gross_income) AS total_gross_income FROM sales GROUP BY Branch ORDER BY total_gross_income DESC LIMIT 1;","SELECT Branch, SUM(gross_income) AS total_gross_income FROM sales GROUP BY Branch ORDER BY total_gross_income DESC LIMIT 1;","  branch total_gross_income
0      C          5265.1765",Correct,Almost Correct
How does the quantity sold vary with each payment method?,"SELECT Payment, AVG(Quantity) AS avg_quantity FROM sales GROUP BY Payment ORDER BY avg_quantity DESC;","SELECT Payment, AVG(Quantity) AS avg_quantity FROM sales GROUP BY Payment ORDER BY avg_quantity DESC;","       Payment avg_quantity
0  Credit card       5.5370
1         Cash       5.5116
2      Ewallet       5.4841",Correct,Almost Correct
What is the most common product line for transactions above 500?,SELECT Product_line AS most_common_product_line FROM sales WHERE Total > 500 GROUP BY Product_line ORDER BY COUNT(*) DESC LIMIT 1;,"SELECT Product_line, COUNT(*) AS product_count FROM sales WHERE Total > 500 GROUP BY Product_line ORDER BY product_count DESC;","  most_common_product_line
0        Sports and travel",Wrong Answer,Almost Correct
How many transactions did each gender make during time 18 and 21?,"SELECT Gender, COUNT(Invoice_ID) AS transactions FROM sales WHERE HOUR(Time) IN (18, 21) GROUP BY Gender;","SELECT Gender, COUNT(Invoice_ID) AS transaction_count FROM sales WHERE HOUR(Time) BETWEEN 18 AND 21 GROUP BY Gender ORDER BY transaction_count DESC;","   Gender  transactions
0    Male            48
1  Female            45",Wrong Answer,Wrong Answer
